---
title: "Project 3: p3package Tutorial"
author: "Joia Zhang"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{p3package Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
The p3package package contains functions for statistical prediction and statistical inference. Included are one sample t-test, linear model, K-nearest neighbors, and random forest functions. Such functions may be useful for conducting hypothesis testing, modeling, and prediction.

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Installation

You can install the p3package package using the following line:

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("joiazhang/p3package", build_vignette = TRUE, build_opts = c())
library(p3package)
```

## Tutorials
```{r}
library(p3package)
```

### `my_t.test` Tutorial
A p-value cut off of $\alpha = 0.05$ will be used in these tutorials.
#### Example 1: A test of the hypothesis
\begin{align}
H_0: \mu &= 60,\\
H_a: \mu &\neq 60.
\end{align}

```{r}
# alternative = two.sided is the default
ttest1 <- my_t.test(x = my_gapminder$lifeExp, mu = 60)
ttest1
```
The p-value (`ttest1$p_val`) is greater than the p-value threshold of $\alpha = 0.05$ so there is not sufficient evidence to reject the null hypothesis. 

#### Example 2: A test of the hypothesis
\begin{align}
H_0: \mu &= 60,\\
H_a: \mu &< 60.
\end{align}

```{r}
ttest2 <- my_t.test(x = my_gapminder$lifeExp, alternative = "less", mu = 60)
ttest2
```
The p-value (`ttest2$p_val`) is less than the p-value threshold of $\alpha = 0.05$ so there is sufficient evidence to reject the null hypothesis. 

#### Example 3: A test of the hypothesis
\begin{align}
H_0: \mu &= 60,\\
H_a: \mu &> 60.
\end{align}

```{r}
ttest3 <- my_t.test(x = my_gapminder$lifeExp, alternative = "greater", mu = 60)
ttest3
```
The p-value (`ttest2$p_val`) is much greater than the p-value threshold of $\alpha = 0.05$ so there is definitely not sufficient evidence to reject the null hypothesis. 


### `my_lm` Tutorial

```{r}
lm_fit <- my_lm(lifeExp ~ gdpPercap + continent, data = my_gapminder)
gdp_coeff <- lm_fit$Coefficients["gdpPercap", "Estimate"]
gdp_p_val <- lm_fit$Coefficients["gdpPercap", "Pr(>|t|)"]
# plot actual vs fitted
mod_fits <- lm_fit$ybar
# create data frame for plotting
my_df <- data.frame(actual = my_gapminder$lifeExp, fitted = mod_fits)
ggplot(my_df, aes(x = fitted, y = actual)) +
  geom_point() +
  geom_abline(slope = 1, intercept = 0, col = "red", lty = 2) +
  theme_bw(base_size = 15) +
  labs(x = "Fitted values", y = "Actual values", title = "Actual vs. Fitted") +
  theme(plot.title = element_text(hjust = 0.5))
```
While the gdpPercap coefficient is very small (`r gdp_coeff`), it is still significant. The null hypothesis for the gdpPercap coefficient is that it does affect life expectancy significantly. The alternative hypothesis is that gdpPercap does affect life expectancy significantly. The p-value for the gdpPercap coefficient is `r gdp_p_val` which is much below the p-value cut off of 0.05. Thus, there is sufficient evidence to reject the null hypothesis and conclude that gdp per capita affects life expectancy.

The Actual vs. Fitted plot shows that the model fit has four clusters. Each cluster is poorly fitted by the model.
